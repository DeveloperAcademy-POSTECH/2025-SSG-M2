> [!question] 
> GQ1. 클로저를 알기위해 무엇을 알아야 될까? 
> GQ2. 클로저의 기능은 무엇일까?

## Description

- GQ1 : 클로저를 제대로 알기 위해선, 일급객체로서의 함수를 알아야 됩니다. 일급객체로서의 함수란
    1. 객체가 런타임에도 생성이 가능해야한다.
    2. 인자값으로 객체를 전달할 수 있어야한다.
    3. 반환값으로 객체를 사용할 수 있어야 한다.
    4. 변수나 데이터 구조 안에 저장할 수 있어야 한다.
    5. 할당에 사용된 이름과 관계없이 고유한 구별이 가능해야 한다.

---

이 다섯가지 특성들을 만족하면, 이를 일급 함수라고 합니다.

이 같은 특성을 알아본 이유는 "함수를 변수처럼 다룰 수 없다면" 클로저도 불가능하기 때문입니다.

또한 스코프와 렉시컬 스코프에 대해 알아야 하는데, 반한된 내부함수가 자신이 선언됐을 때의 환경(렉시컬 스콮)인 스코프를 기억하여 자신이 선언됐을 때의 환경(스코프) 밖에서 호출되어도 그 환경(스코프) 접근할 수 있는 함수입니다.

말이 매우 어려운데, 결국 자신이 생성될 때의 환경을 기억하는 함수입니다. ( 이 내용이 _**클로저캡처**_ )

이제 클로저에 대해 설명이 가능합니다. 클로저는 두가지로 이루어진 객체인데, 하나는 내부함수, 또 다른 하나는 내부함수가 만들어진 주변환경입니다. 또한 클로저는 외부함수 내에서 내부함수를 반환, 내부함수가 외부함수의 지역변수나 상수를 참조할 때도 사용됩니다.

예시를 들자면 "클로저는 배달음식과 냉장고를 같이 들고 다니는 셰프" 인건데, 외부함수 -> 주방, 외부함수의 지역변수 -> 주방 냉장고 안 재료 , 셰프 -> 내부함수 클로저 -> 주방 밖으로 셰프가 나가면서도 냉장고 안 재료를 들고 나간 것

즉 ! 주방 밖에서는 냉장고 접근 자체가 불가 ! 하지만 클로저는 그걸 기억하고 들고 다니니깐 언제든지 냉장고 안 요리재료를 꺼내서 요리를 할 수 있는 것입니다 !

즉, 함수 밖에 있던 변수도 계속 사용할 수 있게 들고있는것.

```swift
func makeCounter() -> () -> Int {
	var count = 0

	let counter = {
		count += 1
		return count
	}
	return counter
}
let myCounter = makeCounter()
print(myClolor()) = // 1
print(myClolor()) = // 2
print(myClolor()) = // 3

```

여기까지가 클로저 캡처에 대한 내용입니다. 기능에서 자세히 다루고 다음내용으로 넘어가도록 하겠습니다.

---

클로저는 3가지 형태 중 하나를 취합니다.

- 전역 함수는 이름을 가지고 어떠한 값도 캡처하지않는 클로저입니다.
- 중첩 함수는 이름을 가지고 둘러싼 함수로 부터 값을 캡처할 수 있는 클로저입니다.
- 클로저 표현식은 주변 컨텍스트에서 값을 캡처할 수 있는 경량 구문으로 작성된 이름이 없는 클로저입니다.

## 주요 기능

- 값 캡처 -> 위에서 말했듯이 자신이 만들어진 당시의 변수들을 기억하고 있다.
    
- func makeCounter() -> () -> Int {
    

var count = 0

return {         count += 1

return count     } }

let counter = makeCounter()

print(counter()) // 1

print(counter()) // 2

````
=> count는 함수 안 변수지만, 클로저가 캡처해서 계속 사용 가능 !
- 익명함수 기능
```swift
let sayHi = {print("Hi")}
- sayHi() // 출력 Hi 됨
````

=> 이름이 없어도 클로저 자체가 하나의 함수처럼 동작

- 값 처럼 전달 가능 ( 일급 객체 특성)

```swift
func runTask(task: () -> Void) {
  task()
}
runTask {
  print("클로저 실행중")
}
```

=> 함수처럼 넘길 수 있는 덕분에 _**재사용**_ 이나 _**비동기 처리**_ 에 좋음

- Closure은 사용자의 액션에 반응할 때, _**뷰의 생명주기에 따라 어떤 동작을 하고 싶을 때**_

## 코드 예시

- Button 에서의 클로저

```swift
struct MyView: View {
  var body: some View {
  	Button(action: { //뒤의 클로저가 버튼 클릭 시 실행됨
  		print("버튼이 눌렸습니다!")
  		}) {
  		Text("클릭")
  	}
  }
}

```

- 흔한 클로저 형태

```swift
let numbers = [1, 2, 3, 4, 5]

// 클로저 표현식 사용

let doubled = numbers.map { number in

    return number * 2

}
//축약버전
let doubled = numbers.map { $0 * 2}
  //number in 생략
  //$0은 첫번 째 파라미터

print(doubled) // [2, 4, 6, 8, 10]

```

## Keywords

- 일급객체,렉시컬 스코프, 캡처,익명함수,표현식,고차함수

## References

- 꼼꼼한 재은씨의 Swift 책
- [](https://velog.io/@chojs28/%EB%A0%89%EC%8B%9C%EC%BB%AC-%EC%8A%A4%EC%BD%94%ED%94%84%EC%99%80-%ED%81%B4%EB%A1%9C%EC%A0%80-%EA%B7%B8%EB%A6%AC%EA%B3%A0-%EC%BB%A4%EB%A7%81)[https://velog.io/@chojs28/렉시컬-스코프와-클로저-그리고-커링](https://velog.io/@chojs28/%EB%A0%89%EC%8B%9C%EC%BB%AC-%EC%8A%A4%EC%BD%94%ED%94%84%EC%99%80-%ED%81%B4%EB%A1%9C%EC%A0%80-%EA%B7%B8%EB%A6%AC%EA%B3%A0-%EC%BB%A4%EB%A7%81)
- Apple Developer 공식 문서